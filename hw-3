--Get count of unique ship_name for each ship country in orders  table
select 
	count (distinct  ship_name) amount_ship_name,
	ship_country 
from orders
group by ship_country 
order by ship_country; 

--Retrieve all first names from employees
select distinct 
	first_name 	
from employees;

--Retrieve all cities where orders were shipped
select distinct  
	ship_city,
	ship_country
from orders
order by ship_country;

--Get all orders sorted by ship country 
select 
	order_id 	
from orders 
order by ship_country;

--Get all orders sorted by customer_id in descending order
select 
	order_id,
	customer_id 
from orders 
order by customer_id desc;

--Get products from category with max average price 
select 
	category_id
from (select 
	avg(unit_price) as avg_price,
	category_id 
from products
group by category_id
order by avg_price desc
limit 1) as tab;

select 
	product_name, 
	category_id 
from products 
where category_id in (select 
	category_id
from (select 
	avg(unit_price) as avg_price,
	category_id 
from products
group by category_id
order by avg_price desc
limit 1) as tab);

--Get three categories with the largest quantity of products in stock
select 
	category_id,
	count(product_id) as quantity_products
from products 
group by category_id 
order by quantity_products desc
limit 3;

--Show all info about the employee with ID 8.
select 
	*
from employees 
where employee_id = 8;

--Show the list of first and last names of the employees from London.
select
	first_name,
	last_name 
from employees 
where city = 'London';

--Show the list of first and last names of the employees whose first name begins with letter A.
select 
	first_name,
	last_name 
from employees 
where starts_with(first_name,'A');

select 
	first_name,
	last_name 
from employees 
where first_name like 'A%';

--Calculate the count of employees from London.
select
	count(employee_id)
from employees 
where city = 'London';
