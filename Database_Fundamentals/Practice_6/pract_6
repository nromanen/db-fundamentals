		--PRACTICE_6


--1. Show the list of French customers’ names who are working in the same cities.

	select c.company_name, c.city 
	from customers c 
	order by c.city;

--2. Show the list of German suppliers’ names who are not working in the same cities.

	

--3. Show the count of orders made by each customer from France.

	select c.customer_id, count(c.customer_id) 
	from customers c 
	inner join orders o on o.customer_id=c.customer_id and c.country='France' 
	group by c.customer_id;

--4. Show the list of French customers’ names who have made more than one order.

	select *
	from (
			select c.customer_id, count(c.customer_id) 
			from customers c 
			inner join orders o on o.customer_id=c.customer_id and c.country='France' group by c.customer_id
		  )
	as counter
	where counter.count > 1
	order by counter.count;

--5. Show the list of customers’ names who used to order the ‘Tofu’ product.

	select *
	from customers c
	inner join orders o on o.customer_id=c.customer_id
	inner join order_details od on od.order_id=o.order_id
	inner join products p on od.product_id=p.product_id
	where p.product_name='Tofu';

--6.Show the list of French customers’ names who used to order non-French products.

	select c.company_name 
	from suppliers s 
	inner join products p on p.supplier_id=s.supplier_id 
	inner join order_details od on p.product_id=od.product_id 
	inner join orders o on od.order_id=o.order_id 
	inner join customers c on o.customer_id=c.customer_id
	where s.country not in ('France') and c.country in ('France') group by c.company_name;

--7. Show the list of French customers’ names who used to order French products.

	select c.company_name 
	from suppliers s 
	inner join products p on p.supplier_id=s.supplier_id 
	inner join order_details od on p.product_id=od.product_id 
	inner join orders o on od.order_id=o.order_id 
	inner join customers c on o.customer_id=c.customer_id
	where s.country in ('France') and c.country in ('France') group by c.company_name;


