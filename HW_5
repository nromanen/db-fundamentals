/*
1.Show first and last names of the employees who used to serve orders shipped to Madrid.
 The result set would be ordered by first name.
*/

select distinct e.first_name,
	e.last_name
from orders o
join employees e on o.employee_id = e.employee_id
where o.ship_city = 'Madrid'
order by e.first_name;


/*
2.Write the query, which will show the first and last names of the employees (whether they served orders or not)
as well as the count of orders (CountOfOrders) where served by each of them.
*/


select first_name, last_name, count(o.order_id) as count_of_orders
from employees e
left join orders o on o.employee_id = e.employee_id
group by e.employee_id
order by e.first_name;


/*
3.Show first and last names of the employees as well as
 the count of their orders shipped after required date during the year 1997 (use left join).
*/

select e.first_name , e.last_name , count(o.order_id) as count_of_orders
from employees e
left join orders o on o.employee_id = e.employee_id
where extract('YEAR' from o.shipped_date) = 1997 and o.shipped_date >= o.required_date
group by e.first_name, e.last_name
order by e.first_name;


/*
5.
Show the list of french customersâ€™ names who have made more than one order
*/

select contact_name , count(o.order_id) as count_of_order
from customers c
join orders o on c.customer_id = o.customer_id
where c.country = 'France'
group by c.customer_id
having count(o.order_id) > 1
order by contact_name asc;
