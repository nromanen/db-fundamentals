--Practice

--Show the list of French customers’ names who are working in the same cities.

select distinct  c1.company_name
from customers c1
inner join customers c2 on c1.city = c2.city 
where c1.country = 'France' and c1.customer_id <> c2.customer_id;



 --Show the list of German suppliers’ names who are not working in the same cities.
 
select distinct  c1.company_name
from customers c1
inner join customers c2 on c1.city != c2.city 
where c1.country = 'Germany' and c1.customer_id <> c2.customer_id;



--Show the count of orders made by each customer from France.

select c.company_name, count(o.order_id) as orderCount
from customers c
inner join orders o ON c.customer_id = o.customer_id 
WHERE c.country = 'France'
GROUP BY c.company_name;



--Show the list of French customers’ names who have made more than one order.

select c.company_name, count(o.order_id) as orderCount
from customers c
inner join orders o ON c.customer_id = o.customer_id 
WHERE c.country = 'France' 
GROUP BY c.company_name
having count(o.order_id) > 1;



--Show the list of customers’ names who used to order the ‘Tofu’ product.

select c.company_name
from customers c 
join orders o on c.customer_id = o.customer_id 
join order_details od on o.order_id = od.order_id
join products p on od.product_id = p.product_id
where product_name = 'Tofu';



--Show the list of French customers’ names who used to order non-French products.

select c.company_name 
from customers c 
join orders o on c.customer_id = o.customer_id 
join order_details od on o.order_id = od.order_id 
join products p on p.product_id = od.product_id 
join suppliers s on s.supplier_id = p.supplier_id 
where c.country = 'France' and s.country !='France'
group by c.company_name;



--Show the list of French customers’ names who used to order French products.

select c.company_name 
from customers c 
join orders o on c.customer_id = o.customer_id 
join order_details od on o.order_id = od.order_id 
join products p on p.product_id = od.product_id 
join suppliers s on s.supplier_id = p.supplier_id 
where c.country = 'France' and s.country ='France'
group by c.company_name;



--Home Work


--Show the total ordering sum calculated for each country of customer.

select c.country, count(od.quantity)
from customers c 
join orders o on o.customer_id = c.customer_id 
join order_details od on od.order_id = o.order_id 
group by c.country;



--Show the list of product categories along with total ordering sums calculated for the orders made for the products of each category, during the year 1997.

select p.product_name, count(o.order_id)
from products p
join categories c on p.category_id = c.category_id
join order_details od on od.product_id = p.product_id 
join orders o on o.order_id = od.order_id 
where extract(year from o.order_date) = 1997
group by c.category_id, p.product_name;




--Show the list of product names along with unit prices and the history of unit prices taken from the orders (show ‘Product name – Unit price – Historical price’).
--The duplicate records should be eliminated. If no orders were made for a certain product, then the result for this product should look like ‘Product name – Unit price – NULL’.
--Sort the list by the product name.

select distinct p.product_name, p.unit_price, od.unit_price as historical_price
from products p
join order_details od on p.product_id = od.product_id 
where p.unit_price != od.unit_price 
order by p.product_name;
