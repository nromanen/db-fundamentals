--Home Work

--Create a report that shows the product name and supplier id for all products supplied by Exotic Liquids, Grandma Kelly's Homestead, and Tokyo Traders.

select product_name, supplier_id
from products p 
where supplier_id  in 
(
select supplier_id
from suppliers s 
where company_name in ('Exotic Liquids', 'Grandma Kellys Homestead', 'Tokyo Traders'))



--Create a report that shows all the products which are supplied by a company called ‘Pavlova, Ltd.’.

select product_name, supplier_id
from products p 
where supplier_id  in 
(
select supplier_id
from suppliers s 
where company_name like 'Pavlova, Ltd.');



--Create a report that shows the orders placed by all the customers excluding the customers who belongs to London city.

select order_id, customer_id
from orders o 
where customer_id in (
select customer_id 
from customers c 
where city not like 'London' 
)


--Create a report that shows all the customers if there are more than 30 orders shipped in London city.
select company_name
from customers c
where customer_id in (
    select customer_id
    from orders o
    where ship_city like 'London'
    group by o.customer_id
    having count(order_id) > 30);

   
   
 --Create a report that shows all the orders where the employee’s city and order’s ship city are same.
select order_id, customer_id
from orders o 
where employee_id in (
select employee_id
from employees e
where e.city = o.ship_city
)


--Task 1
--Show first and last names of the employees who have the biggest freight.

select first_name, last_name 
from employees e 
inner join orders o on e.employee_id = o.employee_id
group by e.first_name, e.last_name, e.employee_id
order by max(freight);



--Show first, last names of the employees, their freight who have the freight bigger then avarage.
select e.first_name, e.last_name 
from employees e 
inner join orders o on e.employee_id = o.employee_id
group by e.first_name, e.last_name, e.employee_id, o.freight
having  o.freight > avg(o.freight);



--Show the names of products, that have the biggest price.
select product_name
from products p 
where unit_price = (select max(unit_price)
from products p2);



--Show the name of customers with the freight bigger then avarage.
select company_name
from customers c 
join orders o on c.customer_id = o.customer_id 
group by company_name, o.freight
having  o.freight > avg(o.freight);



--Show the name of supplier  who delivered the cheapest product.
select company_name
from suppliers s
join products p on s.supplier_id = p.supplier_id
where unit_price = (
    select min(unit_price)
    from products
    );
   
