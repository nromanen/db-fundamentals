--1.Show first and last names of the employees who used to serve orders shipped to Madrid. The result set would be ordered by first name.

select e.first_name, e.last_name 
from employees e 
inner join orders o 
on e.employee_id =o.employee_id 
where ship_city like 'Madrid'
group by e.first_name, e.last_name 
order by e.first_name;


--2.Write the query, which will show the first and last names of the employees (whether they served orders or not) 
--as well as the count of orders (CountOfOrders) where served by each of them.
select e.FirstName, e.LastName, count(o.OrderId) as CountOfOrders
from Employees e 
left join Orders o 
on e.EmployeeId = o.EmployeeId
group by e.FirstName, e.LastName
order by e.FirstName;


--3..Show first and last names of the employees as well as the count of their orders shipped after required date during the year 1997 (use left join).
SELECT e.FirstName
, e.LastName
, COUNT(o.OrderID) AS CountOfOrder
FROM Employees e 
LEFT JOIN Orders o ON e.EmployeeID = o.EmployeeID
AND strftime('%Y', o.OrderDate) = '1997' AND o.ShippedDate > o.RequiredDate
GROUP BY e.EmployeeID, e.FirstName, e.LastName
ORDER BY e.FirstName;


--4.Show first and last names of the employees who used to serve orders shipped to Madrid.
select first_name, last_name 
from employees e 
inner join orders o 
on e.employee_id = o.employee_id 
where ship_city like 'Madrid'
group by first_name, last_name;


--5.Show the list of french customersâ€™ names who have made more than one order (use grouping).
select c.contact_name, count(o.order_id) as count_of_order 
from customers c 
inner join orders o 
on c.customer_id = o.customer_id 
where c.country like 'France' 
group  by c.contact_name
order by c.contact_name;
